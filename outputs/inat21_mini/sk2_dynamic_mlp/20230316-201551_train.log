2023-03-16 20:15:55,399 - INFO - --batch_size 128
2023-03-16 20:15:55,400 - INFO - --data inat21_mini
2023-03-16 20:15:55,400 - INFO - --data_dir ./datasets/iNat2021
2023-03-16 20:15:55,400 - INFO - --evaluate False
2023-03-16 20:15:55,400 - INFO - --fold 1
2023-03-16 20:15:55,400 - INFO - --image_only False
2023-03-16 20:15:55,400 - INFO - --metadata geo_temporal
2023-03-16 20:15:55,400 - INFO - --mlp_cin 6
2023-03-16 20:15:55,400 - INFO - --mlp_d 256
2023-03-16 20:15:55,400 - INFO - --mlp_h 64
2023-03-16 20:15:55,400 - INFO - --mlp_n 2
2023-03-16 20:15:55,400 - INFO - --mlp_type c
2023-03-16 20:15:55,400 - INFO - --model_file sk2res2net_dynamic_mlp
2023-03-16 20:15:55,400 - INFO - --model_name sk2res2net101
2023-03-16 20:15:55,400 - INFO - --name sk2_dynamic_mlp
2023-03-16 20:15:55,400 - INFO - --num_classes 10000
2023-03-16 20:15:55,400 - INFO - --num_workers 8
2023-03-16 20:15:55,400 - INFO - --path_log ./outputs/inat21_mini/sk2_dynamic_mlp
2023-03-16 20:15:55,400 - INFO - --pretrained True
2023-03-16 20:15:55,400 - INFO - --random_seed 37
2023-03-16 20:15:55,400 - INFO - --resume latest
2023-03-16 20:15:55,400 - INFO - --save_dir ./outputs
2023-03-16 20:15:55,400 - INFO - --start_lr 0.04
2023-03-16 20:15:55,400 - INFO - --stop_epoch 90
2023-03-16 20:15:55,400 - INFO - --tencrop False
2023-03-16 20:15:55,401 - INFO - --warmup 2
2023-03-16 20:15:55,401 - INFO - Creating model:sk2res2net_dynamic_mlp -> sk2res2net101
2023-03-16 20:15:56,139 - INFO - type: c, cin: 6, d: 256, h: 64, N: 2
2023-03-16 20:15:56,682 - INFO - Successfully load checkpoints/sk2res2net101_epoch_300.pth !
2023-03-16 20:16:00,946 - INFO - => loading checkpoint './outputs/inat21_mini/sk2_dynamic_mlp/fold1_latest.pth'
2023-03-16 20:16:01,862 - INFO - => loaded checkpoint './outputs/inat21_mini/sk2_dynamic_mlp/fold1_latest.pth' (epoch 3)
2023-03-16 20:16:01,862 - INFO - eval epoch 3
2023-03-16 20:16:13,069 - INFO - Test: [0/782]	Time 11.204 (11.204)	Loss 2.6076 (2.6076)	Acc@1 67.969 (67.969)	Acc@5 90.625 (90.625)
2023-03-16 20:18:56,764 - INFO - Test: [200/782]	Time 0.790 (0.870)	Loss 2.9327 (3.0714)	Acc@1 59.375 (56.367)	Acc@5 82.031 (81.297)
2023-03-16 20:21:38,788 - INFO - Test: [400/782]	Time 0.796 (0.840)	Loss 2.9308 (3.0436)	Acc@1 58.594 (56.983)	Acc@5 82.812 (81.821)
2023-03-16 20:24:18,620 - INFO - Test: [600/782]	Time 0.928 (0.827)	Loss 3.0491 (3.0147)	Acc@1 57.812 (57.702)	Acc@5 80.469 (82.343)
2023-03-16 20:26:43,293 - INFO -  * Acc@1 58.240 Acc@5 82.935
2023-03-16 20:26:43,293 - INFO - Max accuracy: 58.2400%
2023-03-16 20:26:43,293 - INFO - Start training
2023-03-16 20:26:49,140 - INFO - Train: [4/90][0/3907]	eta 6:20:31 lr 0.03989044	time 5.8438 (5.8438)	loss 3.4060 (3.4060)	acc@1: 63.9292	acc@5: 79.3605	
2023-03-16 20:28:58,226 - INFO - Train: [4/90][300/3907]	eta 0:26:56 lr 0.03989044	time 0.3931 (0.4483)	loss 5.4262 (4.4006)	acc@1: 28.3407	acc@5: 48.6919	
2023-03-16 20:31:06,876 - INFO - Train: [4/90][600/3907]	eta 0:24:10 lr 0.03989044	time 0.4050 (0.4386)	loss 3.7853 (4.3981)	acc@1: 50.5464	acc@5: 76.6909	
2023-03-16 20:33:15,835 - INFO - Train: [4/90][900/3907]	eta 0:21:50 lr 0.03989044	time 0.4060 (0.4357)	loss 4.6658 (4.3655)	acc@1: 43.8399	acc@5: 63.6820	
2023-03-16 20:35:24,439 - INFO - Train: [4/90][1200/3907]	eta 0:19:34 lr 0.03989044	time 0.3849 (0.4339)	loss 4.0849 (4.3341)	acc@1: 53.0481	acc@5: 69.5157	
2023-03-16 20:37:32,976 - INFO - Train: [4/90][1500/3907]	eta 0:17:21 lr 0.03989044	time 0.3820 (0.4328)	loss 3.6124 (4.3376)	acc@1: 53.3853	acc@5: 74.8715	
2023-03-16 20:39:41,381 - INFO - Train: [4/90][1800/3907]	eta 0:15:10 lr 0.03989044	time 0.4117 (0.4320)	loss 3.2763 (4.3432)	acc@1: 55.6740	acc@5: 83.4963	
2023-03-16 20:41:50,037 - INFO - Train: [4/90][2100/3907]	eta 0:12:59 lr 0.03989044	time 0.3960 (0.4316)	loss 5.9620 (4.3345)	acc@1: 19.4603	acc@5: 37.3741	
2023-03-16 20:43:58,599 - INFO - Train: [4/90][2400/3907]	eta 0:10:49 lr 0.03989044	time 0.4211 (0.4312)	loss 4.9994 (4.3358)	acc@1: 41.1576	acc@5: 58.2539	
2023-03-16 20:46:07,811 - INFO - Train: [4/90][2700/3907]	eta 0:08:40 lr 0.03989044	time 0.4007 (0.4311)	loss 3.7432 (4.3418)	acc@1: 52.7758	acc@5: 76.9192	
2023-03-16 20:48:16,304 - INFO - Train: [4/90][3000/3907]	eta 0:06:30 lr 0.03989044	time 0.4133 (0.4309)	loss 4.3307 (4.3393)	acc@1: 45.9859	acc@5: 64.7073	
2023-03-16 20:50:24,989 - INFO - Train: [4/90][3300/3907]	eta 0:04:21 lr 0.03989044	time 0.4027 (0.4307)	loss 3.0372 (4.3396)	acc@1: 60.1378	acc@5: 80.4443	
2023-03-16 20:52:33,215 - INFO - Train: [4/90][3600/3907]	eta 0:02:12 lr 0.03989044	time 0.4268 (0.4304)	loss 5.3669 (4.3398)	acc@1: 36.7416	acc@5: 52.5763	
2023-03-16 20:54:41,758 - INFO - Train: [4/90][3900/3907]	eta 0:00:03 lr 0.03989044	time 0.3660 (0.4303)	loss 5.3421 (4.3372)	acc@1: 32.1161	acc@5: 51.0666	
2023-03-16 20:54:45,967 - INFO - EPOCH 4 training takes 0:28:02
2023-03-16 20:54:47,063 - INFO - ./outputs/inat21_mini/sk2_dynamic_mlp/fold1_latest.pth saved !!!
2023-03-16 20:54:47,064 - INFO - **********latest test***********
2023-03-16 20:54:47,064 - INFO - eval epoch 4
2023-03-16 20:54:48,016 - INFO - Test: [0/782]	Time 0.949 (0.949)	Loss 2.4967 (2.4967)	Acc@1 70.312 (70.312)	Acc@5 88.281 (88.281)
2023-03-16 20:57:28,282 - INFO - Test: [200/782]	Time 0.790 (0.802)	Loss 2.8154 (2.9314)	Acc@1 60.938 (60.491)	Acc@5 85.156 (83.819)
2023-03-16 21:00:07,843 - INFO - Test: [400/782]	Time 0.948 (0.800)	Loss 2.6471 (2.9065)	Acc@1 64.844 (61.173)	Acc@5 90.625 (84.295)
2023-03-16 21:02:48,486 - INFO - Test: [600/782]	Time 0.791 (0.801)	Loss 2.9073 (2.8764)	Acc@1 63.281 (61.992)	Acc@5 84.375 (84.826)
2023-03-16 21:05:09,114 - INFO -  * Acc@1 62.590 Acc@5 85.367
2023-03-16 21:05:09,115 - INFO - Max accuracy: 62.5900%
2023-03-16 21:05:10,173 - INFO - ./outputs/inat21_mini/sk2_dynamic_mlp/fold1_best.pth saved !!!
2023-03-16 21:05:10,174 - INFO - Exp path: ./outputs/inat21_mini/sk2_dynamic_mlp
2023-03-16 21:05:13,202 - INFO - Train: [5/90][0/3907]	eta 3:16:36 lr 0.03980536	time 3.0192 (3.0192)	loss 4.6288 (4.6288)	acc@1: 47.7274	acc@5: 62.9263	
2023-03-16 21:07:20,560 - INFO - Train: [5/90][300/3907]	eta 0:26:02 lr 0.03980536	time 0.4016 (0.4331)	loss 5.9286 (4.0282)	acc@1: 20.2384	acc@5: 36.0620	
2023-03-16 21:09:28,840 - INFO - Train: [5/90][600/3907]	eta 0:23:43 lr 0.03980536	time 0.5755 (0.4304)	loss 5.6177 (4.0789)	acc@1: 18.1122	acc@5: 38.9157	
2023-03-16 21:11:38,461 - INFO - Train: [5/90][900/3907]	eta 0:21:35 lr 0.03980536	time 0.4260 (0.4309)	loss 4.6825 (4.0963)	acc@1: 42.8196	acc@5: 64.1941	
2023-03-16 21:13:47,925 - INFO - Train: [5/90][1200/3907]	eta 0:19:26 lr 0.03980536	time 0.4047 (0.4311)	loss 3.1140 (4.0970)	acc@1: 59.3844	acc@5: 78.6618	
2023-03-16 21:15:57,138 - INFO - Train: [5/90][1500/3907]	eta 0:17:17 lr 0.03980536	time 0.4548 (0.4310)	loss 2.9516 (4.1350)	acc@1: 64.8163	acc@5: 87.6927	
2023-03-16 21:18:06,740 - INFO - Train: [5/90][1800/3907]	eta 0:15:08 lr 0.03980536	time 0.3846 (0.4312)	loss 2.7900 (4.1241)	acc@1: 63.7181	acc@5: 84.6970	
2023-03-16 21:20:16,095 - INFO - Train: [5/90][2100/3907]	eta 0:12:59 lr 0.03980536	time 0.4063 (0.4312)	loss 4.2952 (4.1378)	acc@1: 48.0769	acc@5: 68.6402	
2023-03-16 21:22:25,013 - INFO - Train: [5/90][2400/3907]	eta 0:10:49 lr 0.03980536	time 0.4205 (0.4310)	loss 3.8264 (4.1416)	acc@1: 55.3843	acc@5: 68.9465	
2023-03-16 21:24:34,196 - INFO - Train: [5/90][2700/3907]	eta 0:08:40 lr 0.03980536	time 0.3875 (0.4310)	loss 5.9007 (4.1411)	acc@1: 17.8931	acc@5: 33.5137	
2023-03-16 21:26:43,321 - INFO - Train: [5/90][3000/3907]	eta 0:06:30 lr 0.03980536	time 0.4208 (0.4309)	loss 4.1942 (4.1529)	acc@1: 53.9201	acc@5: 71.6330	
2023-03-16 21:28:52,182 - INFO - Train: [5/90][3300/3907]	eta 0:04:21 lr 0.03980536	time 0.4113 (0.4308)	loss 4.4307 (4.1558)	acc@1: 52.2872	acc@5: 63.6087	
2023-03-16 21:31:00,042 - INFO - Train: [5/90][3600/3907]	eta 0:02:12 lr 0.03980536	time 0.4210 (0.4304)	loss 4.0187 (4.1624)	acc@1: 59.1418	acc@5: 71.4168	
2023-03-16 21:33:08,016 - INFO - Train: [5/90][3900/3907]	eta 0:00:03 lr 0.03980536	time 0.3935 (0.4301)	loss 4.4981 (4.1630)	acc@1: 42.7856	acc@5: 65.5154	
2023-03-16 21:33:10,749 - INFO - EPOCH 5 training takes 0:28:00
2023-03-16 21:33:11,819 - INFO - ./outputs/inat21_mini/sk2_dynamic_mlp/fold1_latest.pth saved !!!
2023-03-16 21:33:11,820 - INFO - **********latest test***********
2023-03-16 21:33:11,820 - INFO - eval epoch 5
2023-03-16 21:33:12,630 - INFO - Test: [0/782]	Time 0.808 (0.808)	Loss 2.5186 (2.5186)	Acc@1 71.875 (71.875)	Acc@5 92.969 (92.969)
2023-03-16 21:35:44,580 - INFO - Test: [200/782]	Time 0.768 (0.760)	Loss 2.7561 (2.8708)	Acc@1 69.531 (62.815)	Acc@5 85.156 (85.588)
2023-03-16 21:38:10,047 - INFO - Test: [400/782]	Time 0.698 (0.744)	Loss 2.6855 (2.8518)	Acc@1 75.000 (63.412)	Acc@5 85.938 (85.811)
2023-03-16 21:40:48,539 - INFO - Test: [600/782]	Time 0.797 (0.760)	Loss 2.9359 (2.8200)	Acc@1 61.719 (64.164)	Acc@5 84.375 (86.283)
2023-03-16 21:43:05,487 - INFO -  * Acc@1 64.705 Acc@5 86.784
2023-03-16 21:43:05,487 - INFO - Max accuracy: 64.7050%
2023-03-16 21:43:06,539 - INFO - ./outputs/inat21_mini/sk2_dynamic_mlp/fold1_best.pth saved !!!
2023-03-16 21:43:06,540 - INFO - Exp path: ./outputs/inat21_mini/sk2_dynamic_mlp
2023-03-16 21:43:09,730 - INFO - Train: [6/90][0/3907]	eta 3:27:10 lr 0.03969616	time 3.1816 (3.1816)	loss 3.4812 (3.4812)	acc@1: 61.9971	acc@5: 80.7030	
2023-03-16 21:45:18,270 - INFO - Train: [6/90][300/3907]	eta 0:26:18 lr 0.03969616	time 0.4200 (0.4376)	loss 3.7343 (3.9742)	acc@1: 59.0061	acc@5: 73.9354	
2023-03-16 21:47:25,854 - INFO - Train: [6/90][600/3907]	eta 0:23:46 lr 0.03969616	time 0.3826 (0.4315)	loss 3.5511 (3.9581)	acc@1: 59.5354	acc@5: 75.6798	
2023-03-16 21:49:33,890 - INFO - Train: [6/90][900/3907]	eta 0:21:32 lr 0.03969616	time 0.3965 (0.4299)	loss 2.9747 (3.9872)	acc@1: 66.9617	acc@5: 84.2589	
2023-03-16 21:51:42,544 - INFO - Train: [6/90][1200/3907]	eta 0:19:23 lr 0.03969616	time 0.3956 (0.4296)	loss 4.0214 (4.0150)	acc@1: 52.1209	acc@5: 77.8429	
2023-03-16 21:53:50,575 - INFO - Train: [6/90][1500/3907]	eta 0:17:12 lr 0.03969616	time 0.4041 (0.4291)	loss 2.8601 (4.0295)	acc@1: 63.5511	acc@5: 82.9245	
2023-03-16 21:55:58,412 - INFO - Train: [6/90][1800/3907]	eta 0:15:02 lr 0.03969616	time 0.4099 (0.4286)	loss 2.9073 (4.0230)	acc@1: 65.8786	acc@5: 82.9279	
2023-03-16 21:58:06,363 - INFO - Train: [6/90][2100/3907]	eta 0:12:53 lr 0.03969616	time 0.5403 (0.4283)	loss 3.6973 (4.0271)	acc@1: 58.7345	acc@5: 76.6213	
2023-03-16 22:00:13,715 - INFO - Train: [6/90][2400/3907]	eta 0:10:44 lr 0.03969616	time 0.4119 (0.4278)	loss 5.2188 (4.0448)	acc@1: 35.5494	acc@5: 53.8894	
2023-03-16 22:02:21,431 - INFO - Train: [6/90][2700/3907]	eta 0:08:36 lr 0.03969616	time 0.4210 (0.4276)	loss 3.2422 (4.0606)	acc@1: 59.9354	acc@5: 77.9160	
